<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Workhub - Blog</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/src/assets/img/logo_grande.png"
    />
    <style>
      .hero-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 0 0 20px 20px;
      }
      .back-button {
        position: fixed;
        top: 100px;
        left: 30px;
        z-index: 1000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        transition: all 0.3s;
      }
      .back-button:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      }
      .blog-content {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #333;
      }
      .blog-content p {
        margin-bottom: 1.5rem;
      }
      .comment-card {
        transition: all 0.2s;
      }
      .comment-card:hover {
        transform: translateX(5px);
      }
      @media (max-width: 768px) {
        .back-button {
          top: 80px;
          left: 15px;
          width: 40px;
          height: 40px;
        }
        .hero-image {
          height: 250px;
        }
      }
    </style>
  </head>

  <body class="bg-light">
    <!-- ===== Navbar ===== -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
      <div class="container-fluid px-4">
        <a class="navbar-brand d-flex align-items-center" href="#">
          <img
            src="/src/assets/img/logo.png"
            alt="Workhub"
            style="height: 30px"
            class="me-2"
          />
        </a>
        <form class="d-none d-lg-flex mx-4 flex-grow-1">
          <input
            class="form-control me-2"
            type="search"
            placeholder="Título, palabra clave o compañía"
            aria-label="Search"
          />
          <button class="btn btn-primary" type="submit">Encontrar</button>
        </form>
        <ul class="navbar-nav mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="#">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Empleos</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Empresas</a></li>
          <li class="nav-item"><a class="nav-link active" href="#">Recursos</a></li>
          <li class="nav-item">
            <a class="nav-link" href="/src/pages/forums/foros/index.html">Foros</a>
          </li>
        </ul>
        <div class="dropdown ms-3">
          <a
            href="#"
            class="d-flex align-items-center text-dark text-decoration-none dropdown-toggle"
            data-bs-toggle="dropdown"
          >
            <img
              src="/src/assets/img/avatar.jpg"
              id="profilePic"
              alt="user"
              class="rounded-circle me-2"
              width="35"
              height="35"
            />
            <span id="userNameDisplay">username</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li>
              <a class="dropdown-item" href="../candidate/profile/index.html">Ver perfil</a>
            </li>
            <li><a class="dropdown-item" href="#">Configuración</a></li>
            <li><hr class="dropdown-divider" /></li>
            <li>
              <a class="dropdown-item text-danger" href="/src/pages/auth/login.html">Cerrar Sesión</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Botón de regreso flotante -->
    <a href="./blog.html" class="back-button" title="Volver a blogs">
      <i class="bi bi-arrow-left fs-4"></i>
    </a>

    <!-- Loading State -->
    <div id="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-3 text-muted">Cargando blog...</p>
    </div>

    <!-- Contenido del Blog -->
    <main id="blog-content" style="display: none;">
      <!-- Imagen de encabezado -->
      <div class="position-relative">
        <img id="blog-hero-image" src="" alt="Blog Image" class="hero-image" />
      </div>

      <!-- Contenido principal -->
      <article class="container my-5">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <!-- Metadata del blog -->
            <div class="d-flex align-items-center gap-3 mb-3 text-muted">
              <span id="blog-date">
                <i class="bi bi-calendar-event me-1"></i>
                <span class="date-text"></span>
              </span>
              <span id="blog-category">
                <i class="bi bi-tag me-1"></i>
                <span class="category-text"></span>
              </span>
              <span id="blog-comments-count">
                <i class="bi bi-chat me-1"></i>
                <span class="count">0</span> Comentarios
              </span>
            </div>

            <!-- Título -->
            <h1 id="blog-title" class="display-4 fw-bold mb-4"></h1>

            <!-- Autor -->
            <div class="d-flex align-items-center mb-4 pb-4 border-bottom">
              <img
                id="author-avatar"
                src=""
                alt="Autor"
                class="rounded-circle me-3"
                style="width: 50px; height: 50px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-0 fw-bold" id="author-name"></h6>
                <small class="text-muted">Autor</small>
              </div>
            </div>

            <!-- Contenido del blog -->
            <div id="blog-text" class="blog-content mb-5"></div>

            <!-- Separador -->
            <hr class="my-5" />

            <!-- Sección de comentarios -->
            <section id="comments-section">
              <h3 class="mb-4">
                <i class="bi bi-chat-left-text me-2"></i>
                Comentarios (<span id="comments-total">0</span>)
              </h3>

              <!-- Formulario de comentario -->
              <div class="card shadow-sm mb-4">
                <div class="card-body">
                  <h5 class="card-title mb-3">Deja tu comentario</h5>
                  <form id="comment-form">
                    <div class="mb-3">
                      <textarea
                        class="form-control"
                        id="comment-textarea"
                        rows="4"
                        placeholder="Escribe tu comentario..."
                        required
                      ></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">
                      <i class="bi bi-send me-2"></i>Publicar comentario
                    </button>
                  </form>
                  <div id="comment-message" class="mt-3"></div>
                </div>
              </div>

              <!-- Lista de comentarios -->
              <div id="comments-list" class="d-flex flex-column gap-3">
                <!-- Los comentarios se cargarán aquí -->
              </div>

              <!-- Estado vacío -->
              <div id="no-comments" style="display: none;" class="text-center py-5">
                <i class="bi bi-chat-left-text text-muted" style="font-size: 3rem;"></i>
                <p class="text-muted mt-3">No hay comentarios aún. ¡Sé el primero en comentar!</p>
              </div>
            </section>
          </div>
        </div>
      </article>
    </main>

    <!-- Error State -->
    <div id="error-state" style="display: none;" class="container text-center py-5">
      <i class="bi bi-exclamation-triangle text-danger" style="font-size: 4rem;"></i>
      <h3 class="mt-3">Blog no encontrado</h3>
      <p class="text-muted">El blog que buscas no existe o ha sido eliminado.</p>
      <a href="./index.html" class="btn btn-primary mt-3">
        <i class="bi bi-arrow-left me-2"></i>Volver a blogs
      </a>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script type="module" src="/src/controllers/blog/blogDetailController.ts"></script>
  </body>
</html>